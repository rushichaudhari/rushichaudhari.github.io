<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<link rel="icon" href="/assets/images/logo.png">

<title>Automate Google forms without selenium | A collection of random ideas so I don't have to google again</title>

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Automate Google forms without selenium | A collection of random ideas so I don’t have to google again</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Automate Google forms without selenium" />
<meta name="author" content="rushi" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="In the previous year, I had posted a script to fill google forms using selenium, and containerizing it with docker to run it parallelly. This is an alternative way to do the same using post requests. I had created a google form using the default template shown below. Which had fields like To get started we need to capture the request. I’ve used burp suite tool to capture, there are many alternative tools you can google. Capturing Requests Setting up burp Create a localhost proxy in burp Then in the browser settings, put the proxy as localhost You may refer this on how to capture request using burp The CODE For the URL to send request, replace the ‘/viewform’ from the original URL when you open the form manually in browser with ‘/formResponse’, In my case ```{r, engine=’python’, count_lines} URL = “https://docs.google.com/forms/d/e/1FAIpQLSc11NqG6fWqNn327qdb479z6QTrmC7QEwbvH7sB-CQ59iA_ZQ/formResponse” 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 Copy the raw_headers which you get from burpsuite ```python raw_headers=&#39;&#39;&#39; Host: docs.google.com User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:77.0) Gecko/20100101 Firefox/77.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Referer: https://docs.google.com/forms/d/e/1FAIpQLSc11NqG6fWqNn327qdb479z6QTrmC7QEwbvH7sB-CQ59iA_ZQ/viewform?fbzx=5050709467963863140 Content-Type: application/x-www-form-urlencoded Content-Length: 365 Origin: https://docs.google.com Connection: close Cookie: S=spreadsheet_forms=ptyYIUGTE-Wce1eMmds7LWc60bZe_XGHOQKjxWnzIHk; NID=204=0wAwj_KBdtmVpuWOQvMGbyhQS7w9LewGgXAnULqYY-ElcRmhGC1_LeJHUB__Fl7nRmGA89EjUK_6PDO4ihZ0fbL0mohFj5zYKpwCZ3j-DoGFtMo2gzQ0Ck9XabjFSDOGgYvjQXFVE6YuhD9SzX9XKub9zsG7o6KPKNThIYz0f5I; ANID=AHWqTUm_MzyyXf3yDhw_L2TZ3Gx9IL62BowaziQCT57iFP7NiOWn86NfU5A3FRyo Upgrade-Insecure-Requests: 1 &#39;&#39;&#39; Cleaning and converting of the raw_headers into a dictionary 1 2 3 4 5 headrs= dict([[h.partition(&#39;:&#39;)[0], h.partition(&#39;:&#39;)[2].strip()] for h in raw_headers.split(&#39;\n&#39;)]) #removing cookie and blank keys del headrs[&#39;Cookie&#39;] del headrs[&#39;&#39;] Similarly raw_data is data sent as shown in burpsuite, copy that into raw_data raw_data=&#39;entry.2092238618=test1&amp;entry.1556369182=test1%40gmail.com&amp;entry.479301265=asdasd&amp;entry.1753222212=Day+1&amp;entry.1753222212=Day+3&amp;entry.588393791=Vegetarian&amp;entry.2109138769=Yes&amp;entry.1753222212_sentinel=&amp;entry.588393791_sentinel=&amp;entry.2109138769_sentinel=&amp;fvv=1&amp;draftResponse=%5Bnull%2Cnull%2C%225050709467963863140%22%5D%0D%0A&amp;pageHistory=0&amp;fbzx=5050709467963863140&#39; The raw_data is url-encoded, we need to url-decode it first raw_data= urllib.parse.unquote(raw_data) Cleaning and fetching the keys of raw_data 1 2 3 4 5 6 7 raw_data=raw_data.split(&#39;&amp;&#39;) data={} for x in raw_data[:-4]: data[x.split(&#39;=&#39;)[0]]=x.split(&#39;=&#39;)[1] data= {k: v for k, v in data.items() if v is not &#39;&#39;} print(data.keys()) Next we generate a custom dictionary with the keys fetched and their respective values as custom values Note:- **For multiple values like checkboxes we can also pass as a list like **‘entry.1753222212’: [‘Day 1’, ‘Day 3’] here. 1 2 3 4 5 6 7 8 data = { &quot;entry.2092238618&quot;:&quot;johnwick&quot;, &#39;entry.1556369182&#39;: &#39;johnw@gmail.com&#39;, &#39;entry.479301265&#39;: &#39;dheknyasorg&#39;, &#39;entry.1753222212&#39;: [&#39;Day 1&#39;, &#39;Day 3&#39;], &#39;entry.588393791&#39;: &#39;Vegan&#39;, &#39;entry.2109138769&#39;: &#39;Yes&#39;, } Now everything is ready, we only need to send a post request with our parameters. # sending post request and saving response as response object r = requests.post(url = URL, data = data, headers=headrs) # status 200=success resp = r.status_code print(&quot;The ResponseL is:%s&quot;%resp) A response would get recorded in the google form if status_code is 200. Full code here https://github.com/rushic24/Automating-Forms-Google-Forms/tree/master/Method2-%20Post%20Requests" />
<meta property="og:description" content="In the previous year, I had posted a script to fill google forms using selenium, and containerizing it with docker to run it parallelly. This is an alternative way to do the same using post requests. I had created a google form using the default template shown below. Which had fields like To get started we need to capture the request. I’ve used burp suite tool to capture, there are many alternative tools you can google. Capturing Requests Setting up burp Create a localhost proxy in burp Then in the browser settings, put the proxy as localhost You may refer this on how to capture request using burp The CODE For the URL to send request, replace the ‘/viewform’ from the original URL when you open the form manually in browser with ‘/formResponse’, In my case ```{r, engine=’python’, count_lines} URL = “https://docs.google.com/forms/d/e/1FAIpQLSc11NqG6fWqNn327qdb479z6QTrmC7QEwbvH7sB-CQ59iA_ZQ/formResponse” 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 Copy the raw_headers which you get from burpsuite ```python raw_headers=&#39;&#39;&#39; Host: docs.google.com User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:77.0) Gecko/20100101 Firefox/77.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Referer: https://docs.google.com/forms/d/e/1FAIpQLSc11NqG6fWqNn327qdb479z6QTrmC7QEwbvH7sB-CQ59iA_ZQ/viewform?fbzx=5050709467963863140 Content-Type: application/x-www-form-urlencoded Content-Length: 365 Origin: https://docs.google.com Connection: close Cookie: S=spreadsheet_forms=ptyYIUGTE-Wce1eMmds7LWc60bZe_XGHOQKjxWnzIHk; NID=204=0wAwj_KBdtmVpuWOQvMGbyhQS7w9LewGgXAnULqYY-ElcRmhGC1_LeJHUB__Fl7nRmGA89EjUK_6PDO4ihZ0fbL0mohFj5zYKpwCZ3j-DoGFtMo2gzQ0Ck9XabjFSDOGgYvjQXFVE6YuhD9SzX9XKub9zsG7o6KPKNThIYz0f5I; ANID=AHWqTUm_MzyyXf3yDhw_L2TZ3Gx9IL62BowaziQCT57iFP7NiOWn86NfU5A3FRyo Upgrade-Insecure-Requests: 1 &#39;&#39;&#39; Cleaning and converting of the raw_headers into a dictionary 1 2 3 4 5 headrs= dict([[h.partition(&#39;:&#39;)[0], h.partition(&#39;:&#39;)[2].strip()] for h in raw_headers.split(&#39;\n&#39;)]) #removing cookie and blank keys del headrs[&#39;Cookie&#39;] del headrs[&#39;&#39;] Similarly raw_data is data sent as shown in burpsuite, copy that into raw_data raw_data=&#39;entry.2092238618=test1&amp;entry.1556369182=test1%40gmail.com&amp;entry.479301265=asdasd&amp;entry.1753222212=Day+1&amp;entry.1753222212=Day+3&amp;entry.588393791=Vegetarian&amp;entry.2109138769=Yes&amp;entry.1753222212_sentinel=&amp;entry.588393791_sentinel=&amp;entry.2109138769_sentinel=&amp;fvv=1&amp;draftResponse=%5Bnull%2Cnull%2C%225050709467963863140%22%5D%0D%0A&amp;pageHistory=0&amp;fbzx=5050709467963863140&#39; The raw_data is url-encoded, we need to url-decode it first raw_data= urllib.parse.unquote(raw_data) Cleaning and fetching the keys of raw_data 1 2 3 4 5 6 7 raw_data=raw_data.split(&#39;&amp;&#39;) data={} for x in raw_data[:-4]: data[x.split(&#39;=&#39;)[0]]=x.split(&#39;=&#39;)[1] data= {k: v for k, v in data.items() if v is not &#39;&#39;} print(data.keys()) Next we generate a custom dictionary with the keys fetched and their respective values as custom values Note:- **For multiple values like checkboxes we can also pass as a list like **‘entry.1753222212’: [‘Day 1’, ‘Day 3’] here. 1 2 3 4 5 6 7 8 data = { &quot;entry.2092238618&quot;:&quot;johnwick&quot;, &#39;entry.1556369182&#39;: &#39;johnw@gmail.com&#39;, &#39;entry.479301265&#39;: &#39;dheknyasorg&#39;, &#39;entry.1753222212&#39;: [&#39;Day 1&#39;, &#39;Day 3&#39;], &#39;entry.588393791&#39;: &#39;Vegan&#39;, &#39;entry.2109138769&#39;: &#39;Yes&#39;, } Now everything is ready, we only need to send a post request with our parameters. # sending post request and saving response as response object r = requests.post(url = URL, data = data, headers=headrs) # status 200=success resp = r.status_code print(&quot;The ResponseL is:%s&quot;%resp) A response would get recorded in the google form if status_code is 200. Full code here https://github.com/rushic24/Automating-Forms-Google-Forms/tree/master/Method2-%20Post%20Requests" />
<link rel="canonical" href="http://localhost:4000/Automate-Forms-Without-Selenium/" />
<meta property="og:url" content="http://localhost:4000/Automate-Forms-Without-Selenium/" />
<meta property="og:site_name" content="A collection of random ideas so I don’t have to google again" />
<meta property="og:image" content="https://3fxtqy18kygf3on3bu39kh93-wpengine.netdna-ssl.com/wp-content/uploads/2019/07/selenium-webdriver-tutorial.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-07-02T00:00:00-04:00" />
<script type="application/ld+json">
{"@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/Automate-Forms-Without-Selenium/"},"url":"http://localhost:4000/Automate-Forms-Without-Selenium/","headline":"Automate Google forms without selenium","dateModified":"2020-07-02T00:00:00-04:00","datePublished":"2020-07-02T00:00:00-04:00","image":"https://3fxtqy18kygf3on3bu39kh93-wpengine.netdna-ssl.com/wp-content/uploads/2019/07/selenium-webdriver-tutorial.png","author":{"@type":"Person","name":"rushi"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/images/favicon.ico"},"name":"rushi"},"description":"In the previous year, I had posted a script to fill google forms using selenium, and containerizing it with docker to run it parallelly. This is an alternative way to do the same using post requests. I had created a google form using the default template shown below. Which had fields like To get started we need to capture the request. I’ve used burp suite tool to capture, there are many alternative tools you can google. Capturing Requests Setting up burp Create a localhost proxy in burp Then in the browser settings, put the proxy as localhost You may refer this on how to capture request using burp The CODE For the URL to send request, replace the ‘/viewform’ from the original URL when you open the form manually in browser with ‘/formResponse’, In my case ```{r, engine=’python’, count_lines} URL = “https://docs.google.com/forms/d/e/1FAIpQLSc11NqG6fWqNn327qdb479z6QTrmC7QEwbvH7sB-CQ59iA_ZQ/formResponse” 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 Copy the raw_headers which you get from burpsuite ```python raw_headers=&#39;&#39;&#39; Host: docs.google.com User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:77.0) Gecko/20100101 Firefox/77.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Referer: https://docs.google.com/forms/d/e/1FAIpQLSc11NqG6fWqNn327qdb479z6QTrmC7QEwbvH7sB-CQ59iA_ZQ/viewform?fbzx=5050709467963863140 Content-Type: application/x-www-form-urlencoded Content-Length: 365 Origin: https://docs.google.com Connection: close Cookie: S=spreadsheet_forms=ptyYIUGTE-Wce1eMmds7LWc60bZe_XGHOQKjxWnzIHk; NID=204=0wAwj_KBdtmVpuWOQvMGbyhQS7w9LewGgXAnULqYY-ElcRmhGC1_LeJHUB__Fl7nRmGA89EjUK_6PDO4ihZ0fbL0mohFj5zYKpwCZ3j-DoGFtMo2gzQ0Ck9XabjFSDOGgYvjQXFVE6YuhD9SzX9XKub9zsG7o6KPKNThIYz0f5I; ANID=AHWqTUm_MzyyXf3yDhw_L2TZ3Gx9IL62BowaziQCT57iFP7NiOWn86NfU5A3FRyo Upgrade-Insecure-Requests: 1 &#39;&#39;&#39; Cleaning and converting of the raw_headers into a dictionary 1 2 3 4 5 headrs= dict([[h.partition(&#39;:&#39;)[0], h.partition(&#39;:&#39;)[2].strip()] for h in raw_headers.split(&#39;\\n&#39;)]) #removing cookie and blank keys del headrs[&#39;Cookie&#39;] del headrs[&#39;&#39;] Similarly raw_data is data sent as shown in burpsuite, copy that into raw_data raw_data=&#39;entry.2092238618=test1&amp;entry.1556369182=test1%40gmail.com&amp;entry.479301265=asdasd&amp;entry.1753222212=Day+1&amp;entry.1753222212=Day+3&amp;entry.588393791=Vegetarian&amp;entry.2109138769=Yes&amp;entry.1753222212_sentinel=&amp;entry.588393791_sentinel=&amp;entry.2109138769_sentinel=&amp;fvv=1&amp;draftResponse=%5Bnull%2Cnull%2C%225050709467963863140%22%5D%0D%0A&amp;pageHistory=0&amp;fbzx=5050709467963863140&#39; The raw_data is url-encoded, we need to url-decode it first raw_data= urllib.parse.unquote(raw_data) Cleaning and fetching the keys of raw_data 1 2 3 4 5 6 7 raw_data=raw_data.split(&#39;&amp;&#39;) data={} for x in raw_data[:-4]: data[x.split(&#39;=&#39;)[0]]=x.split(&#39;=&#39;)[1] data= {k: v for k, v in data.items() if v is not &#39;&#39;} print(data.keys()) Next we generate a custom dictionary with the keys fetched and their respective values as custom values Note:- **For multiple values like checkboxes we can also pass as a list like **‘entry.1753222212’: [‘Day 1’, ‘Day 3’] here. 1 2 3 4 5 6 7 8 data = { &quot;entry.2092238618&quot;:&quot;johnwick&quot;, &#39;entry.1556369182&#39;: &#39;johnw@gmail.com&#39;, &#39;entry.479301265&#39;: &#39;dheknyasorg&#39;, &#39;entry.1753222212&#39;: [&#39;Day 1&#39;, &#39;Day 3&#39;], &#39;entry.588393791&#39;: &#39;Vegan&#39;, &#39;entry.2109138769&#39;: &#39;Yes&#39;, } Now everything is ready, we only need to send a post request with our parameters. # sending post request and saving response as response object r = requests.post(url = URL, data = data, headers=headrs) # status 200=success resp = r.status_code print(&quot;The ResponseL is:%s&quot;%resp) A response would get recorded in the google form if status_code is 200. Full code here https://github.com/rushic24/Automating-Forms-Google-Forms/tree/master/Method2-%20Post%20Requests","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    
<link href="/assets/css/screen.css" rel="stylesheet">

<link href="/assets/css/main.css" rel="stylesheet">

<script src="/assets/js/jquery.min.js"></script>

</head>




<body class="layout-post">
	<!-- defer loading of font and font awesome -->
	<noscript id="deferred-styles">
		<link href="https://fonts.googleapis.com/css?family=Righteous%7CMerriweather:300,300i,400,400i,700,700i" rel="stylesheet">
		<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
	</noscript>


<!-- Begin Menu Navigation
================================================== -->
<nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top mediumnavigation nav-down">

    <div class="container pr-0">

    <!-- Begin Logo -->
    <a class="navbar-brand" href="/">
    <img src="/assets/images/favicon.ico" alt="A collection of random ideas so I don't have to google again">
    </a>
    <!-- End Logo -->

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarMediumish" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarMediumish">

        <!-- Begin Menu -->

            <ul class="navbar-nav ml-auto">

                
                <li class="nav-item">
                
                
                </li>

                <script src="/assets/js/lunr.js"></script>


<style>
    .lunrsearchresult .title {color: #d9230f;}
    .lunrsearchresult .url {color: silver;}
    .lunrsearchresult a {display: block; color: #777;}
    .lunrsearchresult a:hover, .lunrsearchresult a:focus {text-decoration: none;}
    .lunrsearchresult a:hover .title {text-decoration: underline;}
</style>


<form class="bd-search" onSubmit="return lunr_search(document.getElementById('lunrsearch').value);">
    <input type="text" class="form-control text-small launch-modal-search" id="lunrsearch" name="q" maxlength="255" value="" placeholder="Type and enter..."/>
</form>

<div id="lunrsearchresults">
    <ul></ul>
</div>

<script src="/assets/js/lunrsearchengine.js"></script>

            </ul>

        <!-- End Menu -->

    </div>

    </div>
</nav>
<!-- End Navigation
================================================== -->

<div class="site-content">

<div class="container">

<!-- Site Title
================================================== -->
<div class="mainheading">
    <h1 class="sitetitle">A collection of random ideas so I don't have to google again</h1>
    <p class="lead">
        
    </p>
</div>

<!-- Content
================================================== -->
<div class="main-content">
    <!-- Begin Article
================================================== -->
<div class="container">
    <div class="row">

        <!-- Post Share -->
        <div class="col-md-2 pl-0">
            <div class="share sticky-top sticky-top-offset">
    <p>
        Share
    </p>
    <ul>
        <li class="ml-1 mr-1">
            <a target="_blank" href="https://twitter.com/intent/tweet?text=Automate Google forms without selenium&url=http://localhost:4000/Automate-Forms-Without-Selenium/" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                <i class="fab fa-twitter"></i>
            </a>
        </li>

        <li class="ml-1 mr-1">
            <a target="_blank" href="https://facebook.com/sharer.php?u=http://localhost:4000/Automate-Forms-Without-Selenium/" onclick="window.open(this.href, 'facebook-share', 'width=550,height=435');return false;">
                <i class="fab fa-facebook-f"></i>
            </a>
        </li>

        <li class="ml-1 mr-1">
            <a target="_blank" href="https://www.linkedin.com/shareArticle?mini=true&url=http://localhost:4000/Automate-Forms-Without-Selenium/" onclick="window.open(this.href, 'width=550,height=435');return false;">
                <i class="fab fa-linkedin-in"></i>
            </a>
        </li>

    </ul>
    
    <div class="sep">
    </div>
    <ul>
        <li>
        <a class="small smoothscroll" href="#disqus_thread"></a>
        </li>
    </ul>
    
</div>

        </div>

        <!-- Post -->
        

        <div class="col-md-9 flex-first flex-md-unordered">
            <div class="mainheading">

                <!-- Author Box -->
                <!-- 
                <div class="row post-top-meta">
                    <div class="col-xs-12 col-md-3 col-lg-2 text-center text-md-left mb-4 mb-md-0">
                        
                        <img class="author-thumb" src="/" alt="">
                        
                    </div>
                    <div class="col-xs-12 col-md-9 col-lg-10 text-center text-md-left">
                        <a target="_blank" class="link-dark" href="http://www.rushichaudhari.github.io/profile"></a><a target="_blank" href="" class="btn follow">Follow</a>
                        <span class="author-description"></span>
                    </div>
                </div>
                 -->

                <!-- Post Title -->
                <h1 class="posttitle">Automate Google forms without selenium</h1>

            </div>

            <!-- Adsense if enabled from _config.yml (change your pub id and slot) -->
            
            <!-- End Adsense -->

            <!-- Post Featured Image -->
            

            
            <img class="featured-image img-fluid" src="https://3fxtqy18kygf3on3bu39kh93-wpengine.netdna-ssl.com/wp-content/uploads/2019/07/selenium-webdriver-tutorial.png" alt="Automate Google forms without selenium">
            

            
            <!-- End Featured Image -->

            <!-- Post Content -->
            <div class="article-post">
                <!-- Toc if any -->
                
                <!-- End Toc -->
                <p><img src="..\img\2020-07-02-Automate-Forms-Without-Selenium\46zcd9.jpg" alt="46zcd9" /></p>

<p><span style="font-size:30px;">I</span>n the previous year, I had posted a script to fill google forms using selenium, and containerizing it with docker to run it parallelly. This is an alternative way to do the same using post requests.</p>

<p>I had created a google form using the default template shown below.</p>

<p><img src="..\img\2020-07-02-Automate-Forms-Without-Selenium\image-20200702100957610.png" alt="image-20200702100957610" /></p>

<h4 id="which-had-fields-like">Which had fields like</h4>

<p><img src="..\img\2020-07-02-Automate-Forms-Without-Selenium\image-20200702101526822.png" alt="image-20200702101526822" /></p>

<p>To get started we need to capture the request. I’ve used <strong>burp suite</strong> tool to capture, there are many alternative tools you can google.</p>

<h2 id="capturing-requests">Capturing Requests</h2>

<h4 id="setting-up-burp">Setting up burp</h4>

<p><strong>Create a localhost proxy in burp</strong></p>

<p><img src="..\img\2020-07-02-Automate-Forms-Without-Selenium\image-20200702102944153.png" alt="image-20200702102944153" /></p>

<p><strong>Then in the browser settings, put the proxy as localhost</strong></p>

<p><img src="..\img\2020-07-02-Automate-Forms-Without-Selenium\2.PNG" alt="2" /></p>

<p><img src="..\img\2020-07-02-Automate-Forms-Without-Selenium\3.PNG" alt="3" /></p>

<p><strong>You may refer this on how to capture request using burp</strong></p>

<iframe width="917" height="516" src="https://www.youtube.com/embed/gZtuqbEE6aY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>

<h2 id="the-code">The CODE</h2>

<p>For the URL to send request, replace the ‘/viewform’ from the original URL when you open the form manually in browser with ‘/formResponse’,  In my case</p>

<p>```{r, engine=’python’, count_lines}
URL = “https://docs.google.com/forms/d/e/1FAIpQLSc11NqG6fWqNn327qdb479z6QTrmC7QEwbvH7sB-CQ59iA_ZQ/formResponse”</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="rouge-code"><pre>
Copy the raw_headers which you get from burpsuite

```python
raw_headers='''
Host: docs.google.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:77.0) Gecko/20100101 Firefox/77.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: https://docs.google.com/forms/d/e/1FAIpQLSc11NqG6fWqNn327qdb479z6QTrmC7QEwbvH7sB-CQ59iA_ZQ/viewform?fbzx=5050709467963863140
Content-Type: application/x-www-form-urlencoded
Content-Length: 365
Origin: https://docs.google.com
Connection: close
Cookie: S=spreadsheet_forms=ptyYIUGTE-Wce1eMmds7LWc60bZe_XGHOQKjxWnzIHk; NID=204=0wAwj_KBdtmVpuWOQvMGbyhQS7w9LewGgXAnULqYY-ElcRmhGC1_LeJHUB__Fl7nRmGA89EjUK_6PDO4ihZ0fbL0mohFj5zYKpwCZ3j-DoGFtMo2gzQ0Ck9XabjFSDOGgYvjQXFVE6YuhD9SzX9XKub9zsG7o6KPKNThIYz0f5I; ANID=AHWqTUm_MzyyXf3yDhw_L2TZ3Gx9IL62BowaziQCT57iFP7NiOWn86NfU5A3FRyo
Upgrade-Insecure-Requests: 1
'''
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Cleaning and converting of the raw_headers into a dictionary</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="n">headrs</span><span class="o">=</span> <span class="nb">dict</span><span class="p">([[</span><span class="n">h</span><span class="o">.</span><span class="n">partition</span><span class="p">(</span><span class="s">':'</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">h</span><span class="o">.</span><span class="n">partition</span><span class="p">(</span><span class="s">':'</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">raw_headers</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)])</span>

<span class="c1">#removing cookie and blank keys
</span><span class="k">del</span> <span class="n">headrs</span><span class="p">[</span><span class="s">'Cookie'</span><span class="p">]</span>
<span class="k">del</span> <span class="n">headrs</span><span class="p">[</span><span class="s">''</span><span class="p">]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Similarly raw_data is data sent as shown in burpsuite, copy that into raw_data</p>

<pre><code class="language-Python">raw_data='entry.2092238618=test1&amp;entry.1556369182=test1%40gmail.com&amp;entry.479301265=asdasd&amp;entry.1753222212=Day+1&amp;entry.1753222212=Day+3&amp;entry.588393791=Vegetarian&amp;entry.2109138769=Yes&amp;entry.1753222212_sentinel=&amp;entry.588393791_sentinel=&amp;entry.2109138769_sentinel=&amp;fvv=1&amp;draftResponse=%5Bnull%2Cnull%2C%225050709467963863140%22%5D%0D%0A&amp;pageHistory=0&amp;fbzx=5050709467963863140'

</code></pre>

<p>The raw_data is <a href="https://www.w3schools.com/tags/ref_urlencode.ASP">url-encoded</a>, we need to url-decode it first</p>

<pre><code class="language-Python">raw_data= urllib.parse.unquote(raw_data)
</code></pre>

<p>Cleaning and fetching the keys of raw_data</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="n">raw_data</span><span class="o">=</span><span class="n">raw_data</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">'&amp;'</span><span class="p">)</span>
<span class="n">data</span><span class="o">=</span><span class="p">{}</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">raw_data</span><span class="p">[:</span><span class="o">-</span><span class="mi">4</span><span class="p">]:</span>
    <span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">'='</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">'='</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">data</span><span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="s">''</span><span class="p">}</span>
<span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Next we generate a custom dictionary with the keys fetched and their respective values as custom values</p>

<p><strong>Note:- **For multiple values like checkboxes we can also pass as a list like **‘entry.1753222212’: [‘Day 1’, ‘Day 3’]</strong> here.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">"entry.2092238618"</span><span class="p">:</span><span class="s">"johnwick"</span><span class="p">,</span>
        <span class="s">'entry.1556369182'</span><span class="p">:</span> <span class="s">'johnw@gmail.com'</span><span class="p">,</span>
        <span class="s">'entry.479301265'</span><span class="p">:</span> <span class="s">'dheknyasorg'</span><span class="p">,</span>
        <span class="s">'entry.1753222212'</span><span class="p">:</span> <span class="p">[</span><span class="s">'Day 1'</span><span class="p">,</span> <span class="s">'Day 3'</span><span class="p">],</span>
        <span class="s">'entry.588393791'</span><span class="p">:</span> <span class="s">'Vegan'</span><span class="p">,</span>
        <span class="s">'entry.2109138769'</span><span class="p">:</span> <span class="s">'Yes'</span><span class="p">,</span>
    <span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Now everything is ready, we only need to send a post request with our parameters.</p>

<pre><code class="language-Python"># sending post request and saving response as response object 
r = requests.post(url = URL, data = data, headers=headrs) 

# status 200=success 
resp = r.status_code 
print("The ResponseL is:%s"%resp) 
</code></pre>

<p>A response would get recorded in the google form if status_code is 200.</p>

<p>Full code here <a href="https://github.com/rushic24/Automating-Forms-Google-Forms/tree/master/Method2-%20Post%20Requests">https://github.com/rushic24/Automating-Forms-Google-Forms/tree/master/Method2-%20Post%20Requests</a></p>

            </div>

            <!-- Rating -->
            

            <!-- Post Date -->
            <p>
            <small>
                <span class="post-date"><time class="post-date" datetime="2020-07-02">02 Jul 2020</time></span>           
                
                </small>
            </p>

            <!-- Post Categories -->
            <div class="after-post-cats">
                <ul class="tags mb-4">
                    
                    
                    <li>
                        <a class="smoothscroll" href="/categories#form">form</a>
                    </li>
                    
                    <li>
                        <a class="smoothscroll" href="/categories#google">google</a>
                    </li>
                    
                    <li>
                        <a class="smoothscroll" href="/categories#python">python</a>
                    </li>
                    
                    <li>
                        <a class="smoothscroll" href="/categories#requests">requests</a>
                    </li>
                    
                    <li>
                        <a class="smoothscroll" href="/categories#selenium">selenium</a>
                    </li>
                    
                </ul>
            </div>
            <!-- End Categories -->

            <!-- Post Tags -->
            <div class="after-post-tags">
                <ul class="tags">
                    
                    
                </ul>
            </div>
            <!-- End Tags -->

            <!-- Prev/Next -->
            <div class="row PageNavigation d-flex justify-content-between font-weight-bold">
            
            <a class="prev d-block col-md-6" href="//Trading-View-Scraping/"> &laquo; Webscraping 1 minute stock data from tradingview</a>
            
            
            <a class="next d-block col-md-6 text-lg-right" href="//LSTM-Stock-Prediction-worth-it/">Automate Google forms without selenium &raquo; </a>
            
            <div class="clearfix"></div>
            </div>
            <!-- End Categories -->

        </div>
        <!-- End Post -->

    </div>
</div>
<!-- End Article
================================================== -->

<!-- Begin Comments
================================================== -->

    <div class="container">
        <div id="comments" class="row justify-content-center mb-5">
            <div class="col-md-8">
                <section class="disqus">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname = 'rushichaudhari'; 
        var disqus_developer = 0;
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = window.location.protocol + '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>


            </div>
        </div>
    </div>

<!--End Comments
================================================== -->

<!-- Review with LD-JSON, adapt it for your needs if you like, but make sure you test the generated HTML source code first: 
https://search.google.com/structured-data/testing-tool/u/0/
================================================== -->

</div>


<!-- Bottom Alert Bar
================================================== -->
<div class="alertbar" style="visibility: hidden;">
	<div class="container text-center">
		<span><img src="/assets/images/favicon.ico" alt="A collection of random ideas so I don't have to google again"> &nbsp; Never miss a <b>story</b> from us, subscribe to our newsletter</span>
        <form action="" method="post" name="mc-embedded-subscribe-form" class="wj-contact-form validate" target="_blank" novalidate>
            <div class="mc-field-group">
            <input type="email" placeholder="Email" name="EMAIL" class="required email" id="mce-EMAIL" autocomplete="on" required>
            <input type="submit" value="Subscribe" name="subscribe" class="heart">
            </div>
        </form>
	</div>
</div>

    
</div>

<!-- Categories Jumbotron
================================================== -->
<div class="jumbotron fortags" style="visibility: hidden">
	<div class="d-md-flex h-100">
		<div class="col-md-4 transpdark align-self-center text-center h-100">
            <div class="d-md-flex align-items-center justify-content-center h-100">
                <h2 class="d-md-block align-self-center py-1 font-weight-light">Explore <span class="d-none d-md-inline">→</span></h2>
            </div>
		</div>
		<div class="col-md-8 p-5 align-self-center text-center">
            
            
                
                    <a class="mt-1 mb-1" href="/categories#food">food (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#vegetarian">vegetarian (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#emulator">emulator (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#snes">snes (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#linux">linux (2)</a>
                
                    <a class="mt-1 mb-1" href="/categories#vpn">vpn (2)</a>
                
                    <a class="mt-1 mb-1" href="/categories#digitalocean">digitalocean (2)</a>
                
                    <a class="mt-1 mb-1" href="/categories#i3wm">i3wm (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#thunar">thunar (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#pcmanfm">pcmanfm (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#debian">debian (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#rtl-sdr">rtl-sdr (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#hackrf">hackrf (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#ssd">ssd (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#drive">drive (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#space">space (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#firefox">firefox (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#appdata">appdata (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#temp">temp (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#symlink">symlink (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#kali">kali (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#docker">docker (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#VNC">VNC (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#python">python (3)</a>
                
                    <a class="mt-1 mb-1" href="/categories#requests">requests (3)</a>
                
                    <a class="mt-1 mb-1" href="/categories#selenium">selenium (3)</a>
                
                    <a class="mt-1 mb-1" href="/categories#google">google (3)</a>
                
                    <a class="mt-1 mb-1" href="/categories#form">form (3)</a>
                
            
            
		</div>
	</div>
</div>

<!-- Begin Footer
================================================== -->
<footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-6 col-sm-6 text-center text-lg-left">
                Copyright © 2020 A collection of random ideas so I don't have to google again 
            </div>
            <div class="col-md-6 col-sm-6 text-center text-lg-right">    
                
            </div>
        </div>
    </div>
</footer>
<!-- End Footer
================================================== -->

</div> <!-- /.site-content -->

<!-- Scripts
================================================== -->

<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>

<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>

<script src="/assets/js/mediumish.js"></script>



<script src="/assets/js/ie10-viewport-bug-workaround.js"></script> 


<script id="dsq-count-scr" src="//rushichaudhari.disqus.com/count.js"></script>


</body>
</html>
